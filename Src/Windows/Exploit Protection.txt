powershell -command " #PasteCodeHere "

foreach (Process p in Process.GetProcesses())
{
    string procFile;
    try
    {
      procFile = p.Modules[0].FileName;
    }
    catch (Win32Exception)
    {
      procFile = "n/a";
    }
    MessageBox.Show( p.ProcessName +" path is;" + procFile);
}

Set-MpPreference -EnableNetworkProtection Enabled

Set-ProcessMitigation -Name C:\Windows\System32\notepad.exe -enable dep, EmulateAtlThunks, ForceRelocateImages

Set-ProcessMitigation -system -enable dep, EmulateAtlThunks, ForceRelocateImages

DEP, EmulateAtlThunks, SEHOP, ForceRelocateImages, RequireInfo, BottomUp, HighEntropy, StrictHandle, DisableWin32kSystemCalls, AuditSystemCall, DisableExtensionPoints, BlockDynamicCode, AllowThreadsToOptOut, AuditDynamicCode, CFG, SuppressExports, StrictCFG, MicrosoftSignedOnly, AllowStoreSignedBinaries, AuditMicrosoftSigned, AuditStoreSigned, EnforceModuleDependencySigning, DisableNonSystemFonts, AuditFont, BlockRemoteImageLoads, BlockLowLabelImageLoads, PreferSystem32, AuditRemoteImageLoads, AuditLowLabelImageLoads, AuditPreferSystem32, EnableExportAddressFilter, AuditEnableExportAddressFilter, EnableExportAddressFilterPlus, AuditEnableExportAddressFilterPlus, EnableImportAddressFilter, AuditEnableImportAddressFilter, EnableRopStackPivot, AuditEnableRopStackPivot, EnableRopCallerCheck, AuditEnableRopCallerCheck, EnableRopSimExec, AuditEnableRopSimExec, SEHOP, AuditSEHOP, SEHOPTelemetry, TerminateOnError, DisallowChildProcessCreation, AuditChildProcess